<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8">
<title>Fusion Level04 - Exploit Exercises</title>
<meta name="author" content="Exploit Exercises">

<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="canonical" href="https://exploit-exercises.com/fusion/level04">
<link href="/favicon.png" type="image/png" rel="icon">

</span> <span class="p">);</span>
</span><span class='line'>      <span class="n">from</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>      <span class="o">*</span><span class="n">to</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>    <span class="o">*</span><span class="n">to</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">static</span> <span class="kt">int</span>
</span><span class='line'><span class="nf">hexit</span><span class="p">(</span> <span class="kt">char</span> <span class="n">c</span> <span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span> <span class="n">c</span> <span class="o">&gt;=</span> <span class="sc">&#39;0&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="sc">&#39;9&#39;</span> <span class="p">)</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">c</span> <span class="o">-</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span> <span class="n">c</span> <span class="o">&gt;=</span> <span class="sc">&#39;a&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="sc">&#39;f&#39;</span> <span class="p">)</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">c</span> <span class="o">-</span> <span class="sc">&#39;a&#39;</span> <span class="o">+</span> <span class="mi">10</span><span class="p">;</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span> <span class="n">c</span> <span class="o">&gt;=</span> <span class="sc">&#39;A&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="sc">&#39;F&#39;</span> <span class="p">)</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">c</span> <span class="o">-</span> <span class="sc">&#39;A&#39;</span> <span class="o">+</span> <span class="mi">10</span><span class="p">;</span>
</span><span class='line'>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>       <span class="cm">/* shouldn&#39;t happen, we&#39;re guarded by isxdigit() */</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">static</span> <span class="kt">void</span>
</span><span class='line'><span class="nf">strencode</span><span class="p">(</span> <span class="kt">char</span><span class="o">*</span> <span class="n">to</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">tosize</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">from</span> <span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">tolen</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">for</span> <span class="p">(</span> <span class="n">tolen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">*</span><span class="n">from</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span> <span class="o">&amp;&amp;</span> <span class="n">tolen</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&lt;</span> <span class="n">tosize</span><span class="p">;</span> <span class="o">++</span><span class="n">from</span> <span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span> <span class="n">isalnum</span><span class="p">(</span><span class="o">*</span><span class="n">from</span><span class="p">)</span> <span class="o">||</span> <span class="n">strchr</span><span class="p">(</span> <span class="s">&quot;/_.-~&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">from</span> <span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="mi">0</span> <span class="p">)</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>      <span class="o">*</span><span class="n">to</span> <span class="o">=</span> <span class="o">*</span><span class="n">from</span><span class="p">;</span>
</span><span class='line'>      <span class="o">++</span><span class="n">to</span><span class="p">;</span>
</span><span class='line'>      <span class="o">++</span><span class="n">tolen</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>      <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">sprintf</span><span class="p">(</span> <span class="n">to</span><span class="p">,</span> <span class="s">&quot;%%%02x&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="o">*</span><span class="n">from</span> <span class="o">&amp;</span> <span class="mh">0xff</span> <span class="p">);</span>
</span><span class='line'>      <span class="n">to</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">;</span>
</span><span class='line'>      <span class="n">tolen</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>    <span class="o">*</span><span class="n">to</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>
</div>
<footer>
<div class="sharing">
</div>
</footer>
</article>
</div>
<aside class="sidebar col-md-3">
<section>
<h1>Levels</h2>
<div class="list-group">
<a class="list-group-item " href="/fusion/level00/">Level 00</a>
<a class="list-group-item " href="/fusion/level01/">Level 01</a>
<a class="list-group-item " href="/fusion/level02/">Level 02</a>
<a class="list-group-item " href="/fusion/level03/">Level 03</a>
<a class="list-group-item active" href="/fusion/level04/">Level 04</a>
<a class="list-group-item " href="/fusion/level05/">Level 05</a>
<a class="list-group-item " href="/fusion/level06/">Level 06</a>
<a class="list-group-item " href="/fusion/level07/">Level 07</a>
<a class="list-group-item " href="/fusion/level08/">Level 08</a>
<a class="list-group-item " href="/fusion/level09/">Level 09</a>
<a class="list-group-item " href="/fusion/level10/">Level 10</a>
<a class="list-group-item " href="/fusion/level11/">Level 11</a>
<a class="list-group-item " href="/fusion/level12/">Level 12</a>
<a class="list-group-item " href="/fusion/level13/">Level 13</a>
<a class="list-group-item " href="/fusion/level14/">Level 14</a>
</div>
</section>
</aside>
</div>
</div>
</div>
</div>
<footer role="contentinfo"><div class="container">
<p class="text-muted credits">
<div align="center">Copyright &copy; 2014 - Exploit Exercises</div>
</p>
</div>
</footer>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>
<script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr-2.0.js"></script>
</body>
</html>

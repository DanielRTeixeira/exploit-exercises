<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8">
<title>Level19 - Exploit Exercises</title>
<meta name="author" content="Exploit Exercises">
 
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="canonical" href="https://exploit-exercises.com/nebula/level19">
<link href="/favicon.png" type="image/png" rel="icon">
 
;</span>
</span><span class='line'>  <span class="k">struct</span> <span class="n">stat</span> <span class="n">statbuf</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Get the parent&#39;s /proc entry, so we can verify its user id */</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">snprintf</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;/proc/%d&quot;</span><span class="p">,</span> <span class="n">getppid</span><span class="p">());</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* stat() it */</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="n">stat</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">statbuf</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Unable to check parent process</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* check the owner id */</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="n">statbuf</span><span class="p">.</span><span class="n">st_uid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="cm">/* If root started us, it is ok to start the shell */</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">execve</span><span class="p">(</span><span class="s">&quot;/bin/sh&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">,</span> <span class="n">envp</span><span class="p">);</span>
</span><span class='line'>      <span class="n">err</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Unable to execve&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;You are unauthorized to run this program</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


      </div>
      
        <footer>
          
          
            <div class="sharing">
  
  
  
  
</div>

          
        </footer>
      
    </article>
    
  </div>

  
    <aside class="sidebar col-md-3">
      
        <section>
  <h1>Levels</h1>
  <div class="list-group">
    <a class="list-group-item " href="/nebula/level00/">Level 00</a>
    <a class="list-group-item " href="/nebula/level01/">Level 01</a>
    <a class="list-group-item " href="/nebula/level02/">Level 02</a>
    <a class="list-group-item " href="/nebula/level03/">Level 03</a>
    <a class="list-group-item " href="/nebula/level04/">Level 04</a>
    <a class="list-group-item " href="/nebula/level05/">Level 05</a>
    <a class="list-group-item " href="/nebula/level06/">Level 06</a>
    <a class="list-group-item " href="/nebula/level07/">Level 07</a>
    <a class="list-group-item " href="/nebula/level08/">Level 08</a>
    <a class="list-group-item " href="/nebula/level09/">Level 09</a>
    <a class="list-group-item " href="/nebula/level10/">Level 10</a>
    <a class="list-group-item " href="/nebula/level11/">Level 11</a>
    <a class="list-group-item " href="/nebula/level12/">Level 12</a>
    <a class="list-group-item " href="/nebula/level13/">Level 13</a>
    <a class="list-group-item " href="/nebula/level14/">Level 14</a>
    <a class="list-group-item " href="/nebula/level15/">Level 15</a>
    <a class="list-group-item " href="/nebula/level16/">Level 16</a>
    <a class="list-group-item " href="/nebula/level17/">Level 17</a>
    <a class="list-group-item " href="/nebula/level18/">Level 18</a>
    <a class="list-group-item active" href="/nebula/level19/">Level 19</a>
  </div>
</section>

      
    </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  <div align="center">Copyright &copy; 2014 - Exploit Exercises</div>
</p>

</div>
</footer>
    







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


<script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr-2.0.js"></script>


  </body>
</html>
